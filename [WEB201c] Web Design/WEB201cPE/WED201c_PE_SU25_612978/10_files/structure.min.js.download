((f,g)=>{XF.InserterClick=XF.Event.newHandler({eventNameSpace:"XFInserterClick",options:XF.extendObject(!0,{},XF._baseInserterOptions),inserter:null,init(){this.inserter=new XF.Inserter(this.target,this.options)},click(a){this.inserter.onEvent(a)}});XF.InserterFocus=XF.Element.newHandler({options:XF.extendObject(!0,{},XF._baseInserterOptions),inserter:null,init(){this.inserter=new XF.Inserter(this.target,this.options);XF.on(this.target,"focus",this.inserter.onEvent.bind(this),{once:!0})}});XF.MenuProxy=
XF.Event.newHandler({eventNameSpace:"XFMenuProxy",options:{trigger:null},trigger:null,init(){this.trigger=XF.findRelativeIf(this.options.trigger,this.target);if(!this.trigger)throw Error("Specified menu trigger not found");},click(a){setTimeout(()=>{XF.trigger(this.trigger,XF.customEvent("click",{originalEvent:a}))},0)}});XF.ResponsiveDataList=XF.Element.newHandler({options:{headerRow:".dataList-row--header",headerCells:"th, td",rows:".dataList-row:not(.dataList-row--subSection, .dataList-row--header)",
rowCells:"td",triggerWidth:"narrow"},headerRow:null,headerText:[],rows:null,isResponsive:!1,init(){const a=this.target.querySelector(this.options.headerRow);if(a){const b=[];a.querySelectorAll(this.options.headerCells).forEach(c=>{var d=c.textContent;c=parseInt(c.getAttribute("colspan"),10);b.push(d.trim());if(1<c)for(d=1;d<c;d++)b.push("")});this.headerRow=a;this.headerText=b}this.rows=this.target.querySelectorAll(this.options.rows);this.process();XF.on(g,"breakpoint:change",this.process.bind(this))},
process(){const a=XF.Breakpoint.isAtOrNarrowerThan(this.options.triggerWidth);a&&this.isResponsive||!a&&!this.isResponsive||(a?this.apply():this.remove())},apply(){Array.from(this.rows).forEach(a=>this.processRow(a,!0));this.target.classList.add("dataList--responsive");this.headerRow&&this.headerRow.classList.add("dataList-row--headerResponsive");this.isResponsive=!0},remove(){Array.from(this.rows).forEach(a=>this.processRow(a,!1));this.target.classList.remove("dataList--responsive");this.headerRow&&
this.headerRow.classList.remove("dataList-row--headerResponsive");this.isResponsive=!1},processRow(a,b){let c=0;const d=this.headerText;Array.from(a.querySelectorAll(this.options.rowCells)).forEach(e=>{if(b){const h=d[c];h&&h.length&&!e.dataset.hideLabel?e.setAttribute("data-cell-label",h):e.removeAttribute("data-cell-label")}else e.removeAttribute("data-cell-label");c++})}});XF.Tabs=XF.Element.newHandler({options:{tabs:".tabs-tab",panes:null,activeClass:"is-active",state:null,preventDefault:!0},
initial:0,tabs:null,panes:null,activeTab:null,activePane:null,init(){var a=this.target;let b;b=this.tabs=a.querySelectorAll(this.options.tabs);a=this.options.panes?XF.findRelativeIf(this.options.panes,a):a.nextElementSibling;a.matches("ol, ul")&&(a=Array.from(a.children).filter(c=>"li"===c.tagName.toLowerCase()));this.panes=a;if(b.length!=a.length)console.error("Tabs and panes contain different totals: %d tabs, %d panes",b.length,a.length),console.error("Tabs: %o, Panes: %o",b,a);else{for(a=0;a<b.length;a++)if(b[a].classList.contains(this.options.activeClass)){this.initial=
a;break}b.forEach(c=>{XF.on(c,"click",this.tabClick.bind(this))});XF.on(f,"hashchange",this.onHashChange.bind(this));XF.on(f,"popstate",this.onPopState.bind(this));this.reactToHash()}},getSelectorFromHash(){let a="";if(1<f.location.hash.length){const b=f.location.hash.replace(/[^a-zA-Z0-9_-]/g,"");b&&b.length&&(a="#"+b)}return a},reactToHash(){const a=this.getSelectorFromHash();a?this.activateTarget(a):this.activateTab(this.initial)},onHashChange(a){this.reactToHash()},onPopState(a){(a=a.state)&&
a.id?this.activateTarget("#"+a.id,!1):a&&a.offset?this.activateTab(a.offset):this.activateTab(this.initial)},activateTarget(a){const b=this.tabs;var c=!1;let d=!1;if(a){try{c=g.querySelector(a)||!1}catch(e){c=!1}if(c)for(c=0;c<b.length;c++)b[c].matches(a)&&(this.activateTab(c),d=!0)}d||this.activateTab(this.initial)},activateTab(a){const b=this.tabs[a],c=this.panes[a],d=this.options.activeClass;b&&c?(this.tabs.forEach(e=>{e.classList.contains(d)&&(e.classList.remove(d),e.setAttribute("aria-selected",
"false"),XF.trigger(e,"tab:hidden"))}),this.panes.forEach(e=>{e.classList.contains(d)&&(e.classList.remove(d),e.setAttribute("aria-expanded","false"),XF.trigger(e,"tab:hidden"))}),b.classList.add(d),b.setAttribute("aria-selected","true"),XF.trigger(b,"tab:shown"),c.classList.add(d),c.setAttribute("aria-expanded","true"),XF.trigger(c,"tab:shown"),XF.layoutChange(),c.dataset.href&&!XF.DataStore.get(c,"tab-loading")&&(XF.DataStore.set(c,"tab-loading",!0),XF.ajax("get",c.dataset.href,{},e=>{c.dataset.href=
"";if(e.html){const h=c.dataset.loadTarget,k=c.dataset.sourceSelector;if(k){const l=XF.createElementFromString(e.html.content.trim());e.html.content=l.querySelector(k).outerHTML}h?XF.setupHtmlInsert(e.html,c.querySelector(h)):XF.setupHtmlInsert(e.html,c)}}).finally(()=>XF.DataStore.set(c,"tab-loading",!1)))):console.error("Selected invalid tab "+a)},tabClick(a){var b=a.currentTarget;const c=Array.prototype.indexOf.call(this.tabs,b);if(-1==c)console.error("Did not find clicked element (%o) in tabs",
b);else{b=this.tabs[c];var d=XF.customEvent("tab:click");XF.trigger(b,d);if(!d.defaultPrevented){this.options.preventDefault&&a.preventDefault();if(this.options.state)switch(a=f.location.href.split("#")[0],b.id?(a=a+"#"+b.id,b={id:b.id}):b={offset:c},this.options.state){case "replace":f.history.replaceState(b,"",a);break;case "push":f.history.pushState(b,"",a)}this.activateTab(c)}}}});XF.ToggleClick=XF.Event.newHandler({eventNameSpace:"XFToggleClick",options:{target:null,container:null,hide:null,
activeClass:"is-active",activateParent:null,scrollTo:null},toggleTarget:null,toggleParent:null,toggleUrl:null,ajaxLoaded:!1,loading:!1,init(){this.toggleTarget=XF.getToggleTarget(this.options.target,this.target);if(!this.toggleTarget)return!1;this.options.activateParent&&(this.toggleParent=this.target.parentNode);this.toggleUrl=this.getToggleUrl()},click(a){a.preventDefault();this.toggleTarget&&this.toggle()},isVisible(){return this.toggleTarget.classList.contains(this.options.activeClass)},isTransitioning(){return this.toggleTarget.classList.contains("is-transitioning")},
toggle(){this.isVisible()?this.hide():this.show();this.target.blur()},load(){const a=this.toggleUrl;a&&!this.loading&&(this.loading=!0,XF.ajax("get",a,b=>{b.html&&XF.setupHtmlInsert(b.html,(c,d,e)=>{(d=this.toggleTarget.dataset.loadSelector)&&(d=c.querySelector(d))&&(c=d);this.ajaxLoaded=!0;this.toggleTarget.append(c);XF.activate(c);e(!0);this.show();return!1})}).finally(()=>{this.ajaxLoaded=!0;this.loading=!1}))},hide(a){if(this.isVisible()&&!this.isTransitioning()){var b=this.options.activeClass;
this.toggleParent&&XF.Transition.removeClassTransitioned(this.toggleParent,b,this.inactiveTransitionComplete,a);this.toggleTarget&&XF.Transition.removeClassTransitioned(this.toggleTarget,b,this.inactiveTransitionComplete,a);XF.Transition.removeClassTransitioned(this.target,b,this.inactiveTransitionComplete,a)}},show(a=!1){if(!this.isVisible()&&!this.isTransitioning()&&!Array.from(this.getOtherToggles()).filter(c=>c.classList.contains("is-transitioning")).length)if(this.toggleUrl&&!this.ajaxLoaded)this.load();
else{this.closeOthers();var b=this.options.activeClass;this.toggleParent&&XF.Transition.addClassTransitioned(this.toggleParent,b,this.activeTransitionComplete,a);this.toggleTarget&&XF.Transition.addClassTransitioned(this.toggleTarget,b,this.activeTransitionComplete,a);XF.Transition.addClassTransitioned(this.target,b,this.activeTransitionComplete,a);this.hideSpecified();this.scrollTo();XF.autoFocusWithin(this.toggleTarget,"[autofocus], [data-toggle-autofocus]")}},activeTransitionComplete(a){a.currentTarget&&
(XF.trigger(a.currentTarget,"toggle:shown"),XF.layoutChange())},inactiveTransitionComplete(a){a.currentTarget&&(XF.trigger(a.currentTarget,"toggle:hidden"),XF.layoutChange())},closeOthers(){this.getOtherToggles().forEach(a=>{(a=XF.DataStore.get(a,"xf-click-handlers"))||(a=XF.Event.initElement(this,"click"));a&&a.toggle&&a.toggle.hide(!0)})},hideSpecified(){const a=g.querySelector(this.options.hide);a&&XF.display(a,"none")},scrollTo(){if(this.options.scrollTo){var a=this.toggleTarget;const b=a.getBoundingClientRect().top+
f.scrollY;a=a.offsetHeight;const c=g.documentElement.clientHeight;XF.smoothScroll(a<c?b-(c/2-a/2):b)}},getToggleUrl(){const a=this.toggleTarget,b=a.dataset.href;return a&&b?"trigger-href"==b?this.target.getAttribute("href"):b:null},getContainer(){if(this.options.container){let a=this.target.closest(this.options.container);if(a)return a;console.error("Container parent not found: "+this.options.container)}return null},getOtherToggles(){const a=this.getContainer();return a?Array.from(a.querySelectorAll("[data-xf-click~=toggle]")).filter(b=>
b!==this.target):[]}});XF.getToggleTarget=(a,b)=>{a=a?XF.findRelativeIf(a,b):b.nextElementSibling;if(!a)throw Error("No toggle target for %o",b);return a};XF.CommentToggleClick=XF.extend(XF.ToggleClick,{__backup:{show:"_show"},show(){this._show();const a=this.toggleTarget.querySelector('[data-xf-click~="editor-placeholder"]');a&&a.click()}});XF.ToggleStorage=XF.Element.newHandler({options:{storageType:"local",storageContainer:"toggle",storageKey:null,storageExpiry:86400,target:null,container:null,
hide:null,activeClass:"is-active",activateParent:null},targetId:null,storage:null,init(){const a=this.options.storageContainer;if(!a)throw Error("Storage container not specified for ToggleStorage handler");var b=this.options.storageKey;if(!b)throw Error("Storage key not specified for ToggleStorage handler");this.storage=XF.ToggleStorageData.getInstance(this.options.storageType);if(!this.storage)throw Error("Invalid storage type "+this.options.storageType);b=this.storage.get(a,b,{allowExpired:!1,touch:!1});
if(null!==b){const c=XF.getToggleTarget(this.options.target,this.target);if(c){const d=this.options.activeClass;this.target.classList.toggle(d,b);c.classList.toggle(d,b)}}this.storage.prune(a);XF.on(this.target,"xf-click:after-click.XFToggleClick",this.updateStorage.bind(this))},updateStorage(a){a=this.options;this.storage.set(a.storageContainer,a.storageKey,this.target.classList.contains(a.activeClass),a.storageExpiry)}});XF.ToggleClassClick=XF.Event.newHandler({eventNameSpace:"XFToggleClassClick",
options:{class:null},init(){},click(a){this.options.class&&this.toggle()},toggle(){this.target.classList.toggle(this.options.class)}});XF.VideoInit=XF.Element.newHandler({options:{},video:null,loaded:!1,init(){XF.isIOS()&&(this.video=this.target.cloneNode(!0),this.video.load(),XF.on(this.video,"loadeddata",this.hasLoaded.bind(this)),XF.on(this.video,"seeked",this.hasSeeked.bind(this)))},hasLoaded(){this.loaded||(this.loaded=!0,this.video.currentTime=0)},hasSeeked(){const a=this.target.videoWidth,
b=this.target.videoHeight,c=XF.createElement("canvas",{width:a,height:b});c.getContext("2d").drawImage(this.video,0,0,a,b);c&&c.toBlob(d=>{d&&(d=URL.createObjectURL(d),this.target.setAttribute("poster",d))})}});XF.ShifterClick=XF.Event.newHandler({eventNameSpace:"XFShifterClick",options:{selector:null,dir:"up"},element:null,init(){this.element=this.target.closest(this.options.selector)},click(a){"down"==this.options.dir?(a=this.element.nextElementSibling)&&a.insertAdjacentElement("afterend",this.element):
(a=this.element.previousElementSibling)&&a.insertAdjacentElement("beforebegin",this.element)}});XF.RemoverClick=XF.Event.newHandler({eventNameSpace:"XFRemoverClick",options:{selector:null},targetElement:null,init(){this.targetElement=XF.findRelativeIf(this.options.selector,this.target)},click(a){this.targetElement&&(this.targetElement.remove(),XF.layoutChange())}});XF.DuplicatorClick=XF.Event.newHandler({eventNameSpace:"XFDuplicatorClick",options:{selector:null},targetElement:null,init(){this.targetElement=
XF.findRelativeIf(this.options.selector,this.target)},click(a){this.targetElement&&(a=this.targetElement.cloneNode(!0),this.targetElement.after(a),XF.layoutChange(),this.targetElement.closest("[data-xf-init~=list-sorter]")&&XF.trigger(f,XF.customEvent("listSorterDuplication",{duplicate:a})))}});XF.Event.register("click","inserter","XF.InserterClick");XF.Event.register("click","menu-proxy","XF.MenuProxy");XF.Event.register("click","toggle","XF.ToggleClick");XF.Event.register("click","comment-toggle",
"XF.CommentToggleClick");XF.Event.register("click","toggle-class","XF.ToggleClassClick");XF.Event.register("click","shifter","XF.ShifterClick");XF.Event.register("click","remover","XF.RemoverClick");XF.Event.register("click","duplicator","XF.DuplicatorClick");XF.Element.register("focus-inserter","XF.InserterFocus");XF.Element.register("responsive-data-list","XF.ResponsiveDataList");XF.Element.register("tabs","XF.Tabs");XF.Element.register("toggle-storage","XF.ToggleStorage");XF.Element.register("video-init",
"XF.VideoInit");XF.on(g,"xf:page-load-complete",()=>{var a=f.location.hash.replace(/[^a-zA-Z0-9_-]/g,"");a&&(a=a?g.querySelector("#"+a):null)&&(a=a.closest("[data-toggle-wrapper]"))&&(a=a.querySelector('[data-xf-click~="toggle"]'))&&(a=XF.Event.getElementHandler(a,"toggle","click"))&&a.show(!0)})})(window,document);
